/* styles.css */
:root{
  --bg:#0c0d10;
  --panel:#13151b;
  --muted:#7a8296;
  --text:#e8ecf1;
  --accent:#67e8f9;
  --accent-2:#a78bfa;
  --danger:#ef4444;
  --good:#10b981;
  --warn:#f59e0b;
  --ring:#2563eb;
  --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  --sans: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
  --radius:10px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:var(--sans);
}
.sr-only{position:absolute;left:-9999px}
.app-header{
  display:flex;align-items:center;justify-content:space-between;
  padding:10px 14px;border-bottom:1px solid #1e2230;background:#0e1015;position:sticky;top:0;z-index:2;
}
.branding{display:flex;gap:10px;align-items:center}
.logo{width:22px;height:22px}
.header-actions{display:flex;gap:8px;align-items:center}
.btn{
  background:#1b202d;border:1px solid #273047;color:var(--text);
  padding:8px 12px;border-radius:8px;cursor:pointer;transition:.15s;
}
.btn:hover{border-color:#3a4663}
.btn:disabled{opacity:.5;cursor:not-allowed}
.btn-primary{background:#1c2436;border-color:#31568a;color:#bde1ff}
.btn-danger{background:#2a1515;border-color:#5a1f1f;color:#ffb4b4}
.badge{
  display:inline-block;padding:3px 8px;border-radius:999px;background:#1b2030;border:1px solid #2a3147;
  color:#cfe3ff;font-size:12px;line-height:1;vertical-align:middle;
}
.badge.small{font-size:11px;padding:2px 6px}
.badge.preset{background:#1d2030;border-color:#39425e}
.badge.lens{background:transparent;border:1px dashed #4b5563;color:#b9c3d1}
.badge.model{opacity:.8}
.conn-dot{width:10px;height:10px;border-radius:50%;display:inline-block;background:#555;border:1px solid #333}
.conn-ok{background:var(--good)}
.conn-warn{background:var(--warn)}
.conn-bad{background:var(--danger)}

.main-grid{
  display:grid;grid-template-columns:420px 1fr;gap:16px;padding:16px;align-items:start;
}
.compose,.output,.library,.settings,.modal{
  background:var(--panel);border:1px solid #22283a;border-radius:var(--radius);box-shadow:0 0 0 1px rgba(255,255,255,0.02) inset;
}
.compose{padding:14px;position:sticky;top:70px}
.seed{width:100%;resize:vertical;background:#0f131c;border:1px solid #232a3f;color:var(--text);border-radius:8px;padding:8px;font-size:14px}
.seed-label{display:block;margin:10px 0 6px;color:#c1c7d6}
.preset-tabs, .subtabs{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:10px}
.preset-tabs button, .subtabs button{
  border:1px solid #28314a;background:#121723;color:#cbd5e1;border-radius:999px;padding:6px 10px;font-size:13px;cursor:pointer
}
.preset-tabs button[aria-selected="true"], .subtabs button[aria-selected="true"]{
  background:#1e2a41;border-color:#39507b;color:#d8e7ff
}
.lens-toggles{display:flex;gap:14px;margin:6px 0 12px}
.lens-toggles label{font-size:13px;color:#d1d5e4}
.compose-actions{display:flex;gap:8px;margin:10px 0}
.status-line{display:flex;gap:12px;color:var(--muted);font-size:12px;margin-top:6px}

.output{padding:14px}
.output-scroller{height:420px;overflow:auto;border:1px solid #23304a;border-radius:8px;background:#0e1220;padding:10px}
.out-view{margin:0;white-space:pre-wrap;font-family:var(--mono);line-height:1.45}
#out-plain{width:100%;height:100%;background:transparent;border:0;color:var(--text)}
.quick-actions{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}

.library{padding:14px;grid-column:1/-1}
.library-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.library-filters{display:flex;gap:8px;align-items:center;margin-bottom:10px}
.library-filters input, .library-filters select{
  background:#0f131c;border:1px solid #232a3f;color:var(--text);border-radius:8px;padding:8px;font-size:14px
}
.inline{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.lib-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:12px}
.lib-card{padding:10px;border-radius:8px;border:1px solid #2a3147;background:#0f131c}
.lib-card-head{display:flex;justify-content:space-between;align-items:start;margin-bottom:6px}
.lib-title{font-weight:600;margin-bottom:4px;max-width:36ch;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.lib-meta{display:flex;gap:6px;align-items:center;color:#9aa6bd;font-size:12px}
.star{border:0;background:transparent;color:#f7d26a;font-size:18px;cursor:pointer}
.lib-output{max-height:180px;overflow:auto;background:#0b0f1a;border:1px solid #1b2236;border-radius:6px;padding:8px;font-family:var(--mono)}
.lib-tags{margin-top:6px}
.tag-editor{width:100%;background:#0b0f1a;border:1px dashed #313a53;color:var(--text);border-radius:6px;padding:6px;font-size:13px}
.lib-actions{display:flex;gap:6px;flex-wrap:wrap;margin-top:8px}
.lib-actions .btn-danger{background:#3a1717;border-color:#6b2727}

.settings{position:fixed;top:0;right:0;width:380px;height:100%;display:flex;flex-direction:column}
.settings-header{padding:12px 14px;border-bottom:1px solid #21283c}
.settings-body{padding:12px 14px;display:flex;flex-direction:column;gap:10px}
.settings input[type="text"], .settings input[type="password"]{width:100%;background:#0f131c;border:1px solid #232a3f;color:var(--text);border-radius:8px;padding:8px}
.sliders label{display:flex;align-items:center;gap:10px;justify-content:space-between}
.sliders input[type="range"]{flex:1}
.settings-footer{display:flex;gap:8px;align-items:center;margin-top:8px}
.spacer{flex:1}
.hint{color:#9aa6bd;font-size:12px;margin:-4px 0 6px}

.overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.5);backdrop-filter:blur(2px);z-index:3
}
.modal{
  position:fixed;top:10%;left:50%;transform:translateX(-50%);width:min(720px,92vw);z-index:4;padding:0
}
.modal-header,.modal-footer{padding:10px 12px;border-bottom:1px solid #232a3f}
.modal-footer{border-top:1px solid #232a3f;border-bottom:0;display:flex;gap:8px;justify-content:flex-end}
.modal-body{padding:10px 12px}
.mini-stream{min-height:220px;max-height:420px;overflow:auto;background:#0b0f1a;border:1px solid #1b2236;border-radius:6px;padding:8px;font-family:var(--mono)}

.toasts{position:fixed;bottom:14px;right:14px;display:flex;flex-direction:column;gap:8px;z-index:5}
.toast{background:#101522;border:1px solid #2a3553;color:#dbe7ff;padding:8px 10px;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.25)}
.toast.bad{border-color:#5b2323;color:#ffcccc}
.toast.good{border-color:#1e4635;color:#cffff1}

:focus{outline:2px solid var(--ring);outline-offset:2px}

/* Responsive */
@media (max-width: 980px){
  .main-grid{grid-template-columns:1fr}
  .compose{position:static}
}